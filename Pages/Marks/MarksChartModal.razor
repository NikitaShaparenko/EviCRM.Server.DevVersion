@using Meziantou.Framework
@using Radzen.Blazor
@using EviCRM.Server.Models.MarksChart;
@using System.Globalization

@inject HttpClient _httpClient

@inject Context _context
@inject BackendController bc
@inject SystemCore sc

@inject IHttpClientFactory ClientFactory
@inject IHostEnvironment _env
@inject IWebHostEnvironment _iwebhost

<style>
    .wordwrap {
        word-wrap: break-word; /* Перенос слов */
    }

    .modal-dialog {
        overflow-y: initial !important
    }

    .modal-body {
        max-height: calc(100vh - 200px);
        overflow-y: auto;
    }

    .container {
        border: 1px solid #000000;
        height: 300px;
    }

        .container textarea {
            border: 1px solid red;
            height: 100%;
        }
</style>

<div class="modal fade show" id="myModal" style="display:block; background-color: rgba(10,10,10,.8);" aria-modal="true" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                @if (operationType == "CREATE")
                {
                    <h4 class="modal-title">Поставить новую оценку</h4>
                }
                else if (operationType == "VIEW")
                {
                    <h4 class="modal-title">Просмотр оценки</h4>
                }
                else if (operationType == "EDIT")
                {
                    <h4 class="modal-title">Редактирование оценки</h4>
                }

                <button type="button" class="close" @onclick="@ModalCancel">&times;</button>

            </div>

            <div class="modal-body">

                <p><b>Кому: </b> @user_fullname</p>
                <p><b>За: </b> @mcm.date.ToShortDateString()</p>

                <p>
                    <div class="col-lg-6">

                        @if (operationType != "VIEW")
                        {
                            <select @onchange="(e) => OnMarkNumberChanged(e.Value)" class="me-2">

                                @if (mcm.isTwoMarks)
                                {
                                    <option value="false">1 оценка</option>
                                    <option value="true" selected>2 оценки</option>
                                }
                                else
                                {
                                    <option value="false" selected>1 оценка</option>
                                    <option value="true">2 оценки</option>
                                }

                            </select>
                        }
                        else
                        {
                            <select disabled="true" @onchange="(e) => OnMarkNumberChanged(e.Value)" class="me-2">
                                @if (mcm.isTwoMarks)
                                {
                                    <option value="false">1 оценка</option>
                                    <option value="true" selected>2 оценки</option>
                                }
                                else
                                {
                                    <option value="false" selected>1 оценка</option>
                                    <option value="true">2 оценки</option>
                                }
                            </select>
                        }
                    </div>
                </p>

                @*Первая оценка*@
                <div class="col-lg-4">
                    <label>Первая оценка</label>

                    @if (operationType != "VIEW")
                    {
                        <input id="firstmark" name="first_mark" type="number" min="1" step="1" max="5" @bind=mcm.first_mark class="form-control">
                    }
                    else
                    {
                        <input id="firstmark" readonly="readonly" name="first_mark" type="number" min="1" step="1" max="5" @bind=mcm.first_mark class="form-control">
                    }
                </div>

                @*Описание первой оценки*@
                <div class="col-lg-12">
                    <label>Описание первой оценки</label>
                    @if (operationType != "VIEW")
                    {
                        <textarea style="width: 100%" name="firstdescription" @bind=mcm.first_description></textarea>
                    }
                    else
                    {
                        <textarea style="width: 100%" readonly="readonly" name="firstdescription" @bind=mcm.first_description></textarea>
                    }
                </div>

                <p></p>

                <div class="col-lg-12">
                <p><h6>Файлы к оценке</h6></p>


                <div class="wordwrap">

                    <p></p>
                    <table>

                        <tr>
                            <th scope="col" style="width: 70px;">#</th>
                            <th scope="col" style="width: 300px;">Файл</th>
                            <th scope="col" style="width: 70px;"> </th>
                        </tr>
                        @for (int i = 0; i < attach_first_lst.Count; i++)
                        {
                            string extension = Path.GetExtension(attach_first_lst[i]);
                            int temp = i;
                            <tr>
                                <td>@(i+1))</td>

                                @switch (extension)
                                {
                                    case ".xls":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xls"></i> @attach_first_lst[i]</a></td>
                                        break;

                                    case ".pdf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pdf"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".wav":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-wav"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".7z":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-7z"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".aac":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-aac"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".accdb":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-accdb"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".accdt":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-accdt"></i> @attach_first_lst[i]  </a></td>
                                        break;

                                    case ".amr":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-amr"></i> @attach_first_lst[i]  </a></td>
                                        break;

                                    case ".apk":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-apk"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".app":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-app"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".asax":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-asax"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".asc":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-asc"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".ash":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ash"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".ashx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ashx"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".asp":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-asp"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".aspx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-aspx"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".avi":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-avi"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".axd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-axd"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".bash":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-bash"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".bat":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-bat"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".bin":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-bin"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".bmp":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-bmp"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".bpg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-bpg"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".bz2":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-bz2"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".c":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-c"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".cab":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cab"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".cad":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cad"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".caf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-caf"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".cal":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cal"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".cd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cd"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".cer":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cer"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cfg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cfg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cfm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cfm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cfml":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cfml"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cgi":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cgi"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".class":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-class"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cmd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cmd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".coffee":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-coffee"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".com":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-com"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".conf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-conf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cpp":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cpp"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".crdownload":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-crdownload"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cs":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cs"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".csh":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-csh"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cson":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cson"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".csproj":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-csproj"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".css":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-css"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".csv":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-csv"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".cue":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-cue"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dat":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dat"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".db":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-db"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dbf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dbf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".deb":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-deb"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dgn":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dgn"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dist":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dist"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".diz":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-diz"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dll":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dll"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dmg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dmg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dng":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dng"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".doc":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-doc"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".docb":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-docb"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".docm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-docm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".docx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-docx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dot":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dot"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dotm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dotm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dotx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dotx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".download":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-download"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dpj":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dpj"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dtd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dtd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dwg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dwg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".dxf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-dxf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".exe":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-exe"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".f4v":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-f4v"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".fax":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-fax"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".fb2":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-fb2"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".fla":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-fla"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".flac":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-flac"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".flv":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-flv"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".gif":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-gif"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".gpg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-gpg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".gz":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-gz"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".h":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-h"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".heic":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-heic"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".htm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-htm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".html":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-html"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ico":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ico"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ics":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ics"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".iff":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-iff"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ifo":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ifo"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".image":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-image"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".inf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-inf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ini":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ini"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".jar":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-jar"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".java":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-java"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".jpe":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-jpe"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".jpeg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-jpeg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".jpg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-jpg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".js":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-js"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".json":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-json"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".jsp":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-jsp"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".jsx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-jsx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".key":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-key"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".lnk":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-lnk"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".log":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-log"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".lua":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-lua"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".m":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-m"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".m2v":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-m2v"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".m3u":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-m3u"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".m3u8":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-m3u8"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".m4a":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-m4a"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".m4v":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-m4v"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mdb":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mdb"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mdf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mdf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mid":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mid"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".midi":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-midi"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mkv":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mkv"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mobi":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mobi"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mod":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mod"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mov":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mov"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mp3":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mp3"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mp4":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mp4"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mpa":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mpa"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mpd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mpd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mpeg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mpeg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mpg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mpg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mpp":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mpp"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".mpt":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-mpt"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".msi":

                                        break;
                                    case ".nef":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-nef"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".nfo":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-nfo"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".nix":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-nix"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".odb":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-odb"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ods":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ods"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".odt":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-odt"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ogg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ogg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ost":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ost"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    case ".ott":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ott"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pcd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pcd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pdb":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pdb"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pem":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pem"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pfx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pfx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pgp":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pgp"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".php":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-php"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".png":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-png"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".potx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-potx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pps":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pps"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ppsx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ppsx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ppt":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ppt"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pptm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pptm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pptx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pptx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ps":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ps"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".psd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-psd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pst":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pst"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".pub":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-pub"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".rar":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-rar"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".resx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-resx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".rom":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-rom"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".rpm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-rpm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".rsa":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-rsa"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".rss":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-rss"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".rtf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-rtf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".sass":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-sass"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".scss":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-scss"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".sh":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-sh"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".sldm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-sldm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".sldx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-sldx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".sln":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-sln"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".sql":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-sql"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".sqlite":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-sqlite"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".step":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-step"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".stl":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-stl"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".svg":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-svg"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".swd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-swd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".swf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-swf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".sys":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-sys"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".tar":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-tar"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".tcsh":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-tcsh"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".tex":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-tex"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".tga":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-tga"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".tif":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-tif"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".tiff":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-tiff"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".tmp":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-tmp"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".torrent":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-torrent"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".tsv":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-tsv"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".ttf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-ttf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".txt":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-txt"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".udf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-udf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vb":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vb"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vbproj":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vbproj"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vbs":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vbs"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vcd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vcd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vcs":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vcs"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vdx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vdx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vob":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vob"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vsd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vsd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vss":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vss"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vst":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vst"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vsx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vsx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".vtx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-vtx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".war":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-war"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".wbk":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-wbk"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".webinfo":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-webinfo"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".webm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-webm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".webp":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-webp"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".wma":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-wma"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".wmf":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-wmf"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".wmv":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-wmv"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xaml":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xaml"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xlm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xlm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xlsm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xlsm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xlsx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xlsx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xlt":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xlt"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xltm":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xltm"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xltx":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xltx"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xml":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xml"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xsd":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xsd"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".xz":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-xz"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".yaml":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-yaml"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".yml":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-yml"></i> @attach_first_lst[i] </a></td>
                                        break;
                                    case ".zip":
                                        <td><a href=@attach_first_lst_links[i]><i class="fiv-cla fiv-icon-zip"></i> @attach_first_lst[i] </a></td>
                                        break;

                                    default:
                                        <td><a href=@attach_first_lst_links[i]><i class="bx bx-save">@attach_first_lst[i]</i> </a></td>
                                        break;

                                }
                                <td><button type="button" class="btn btn-danger btn-inverse" @onclick="()=>DeleteAttachment(temp)"> х </button></td>

                            </tr>
                        }

                    </table>

                    @if (file_first_fileName != "")
                    {
                        <p></p>
                        <p><b><i class="bx bx-buoy bx-spin text-primary display-3"></i> Файл загружается на сервер, пожалуйста ожидайте... </b></p>

                        @file_first_fileName
                        <p>
                            <progress value="@file_first_UploadedBytes" max="@file_first_Size"></progress>
                            @(" ") @file_first_UploadedPercentage.ToString("F1") @("% ")
                            @FormatBytes(file_first_UploadedBytes) @(" / ") @FormatBytes(file_first_Size);
                        </p>
                    }

                </div>
                </div>

                @if (operationType == "VIEW")
                {

                }
                else
                {
                    <InputFile OnChange="@LoadFilesAttachments" multiple  class="form-control col-lg-12" />
                }

                <p></p>

                @if (mcm.isTwoMarks)
                {
                    @*Вторая оценка*@
                    <div class="col-lg-4">
                        <label>Вторая оценка</label>
                        @if (operationType != "VIEW")
                        {
                            <input id="secondmark" name="second_mark" type="number" min="1" step="1" max="5" @bind=mcm.second_mark class="form-control">
                        }
                        else
                        {
                            <input id="secondmark" disabled="disabled" name="second_mark" type="number" min="1" step="1" max="5" @bind=mcm.second_mark class="form-control">
                        }
                    </div>

                    @*Описание второй оценке*@
                    <div class="col-lg-12">
                        <label>Описание второй оценки</label>
                        @if (operationType != "VIEW")
                        {
                            <textarea style="width: 100%" name="firstdescription" @bind=mcm.second_description></textarea>
                        }
                        else
                        {
                            <textarea style="width: 100%" name="firstdescription" readonly="readonly" @bind=mcm.second_description></textarea>
                        }
                    </div>

                     <div class="col-lg-12">
                    <p><h6>Файлы к оценке</h6></p>

                    <div class="wordwrap">

                        <p></p>
                        <table>

                            <tr>
                            <th scope="col" style="width: 70px;">#</th>
                            <th scope="col" style="width: 300px;">Файл</th>
                            <th scope="col" style="width: 70px;"> </th>
                            </tr>
                            @for (int i = 0; i < attach_second_lst.Count; i++)
                            {
                                string extension = Path.GetExtension(attach_second_lst[i]);
                                int temp = i;
                                <tr>
                                    <td>@(i+1))</td>

                                    @switch (extension)
                                    {
                                        case ".xls":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xls"></i> @attach_second_lst[i]</a></td>
                                            break;

                                        case ".pdf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pdf"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".wav":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-wav"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".7z":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-7z"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".aac":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-aac"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".accdb":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-accdb"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".accdt":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-accdt"></i> @attach_second_lst[i]  </a></td>
                                            break;

                                        case ".amr":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-amr"></i> @attach_second_lst[i]  </a></td>
                                            break;

                                        case ".apk":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-apk"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".app":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-app"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".asax":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-asax"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".asc":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-asc"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".ash":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ash"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".ashx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ashx"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".asp":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-asp"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".aspx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-aspx"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".avi":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-avi"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".axd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-axd"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".bash":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-bash"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".bat":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-bat"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".bin":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-bin"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".bmp":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-bmp"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".bpg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-bpg"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".bz2":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-bz2"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".c":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-c"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".cab":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cab"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".cad":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cad"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".caf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-caf"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".cal":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cal"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".cd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cd"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".cer":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cer"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cfg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cfg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cfm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cfm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cfml":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cfml"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cgi":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cgi"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".class":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-class"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cmd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cmd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".coffee":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-coffee"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".com":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-com"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".conf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-conf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cpp":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cpp"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".crdownload":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-crdownload"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cs":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cs"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".csh":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-csh"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cson":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cson"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".csproj":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-csproj"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".css":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-css"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".csv":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-csv"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".cue":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-cue"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dat":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dat"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".db":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-db"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dbf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dbf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".deb":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-deb"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dgn":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dgn"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dist":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dist"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".diz":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-diz"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dll":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dll"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dmg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dmg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dng":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dng"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".doc":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-doc"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".docb":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-docb"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".docm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-docm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".docx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-docx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dot":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dot"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dotm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dotm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dotx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dotx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".download":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-download"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dpj":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dpj"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dtd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dtd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dwg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dwg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".dxf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-dxf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".exe":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-exe"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".f4v":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-f4v"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".fax":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-fax"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".fb2":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-fb2"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".fla":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-fla"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".flac":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-flac"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".flv":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-flv"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".gif":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-gif"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".gpg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-gpg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".gz":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-gz"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".h":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-h"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".heic":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-heic"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".htm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-htm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".html":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-html"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ico":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ico"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ics":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ics"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".iff":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-iff"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ifo":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ifo"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".image":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-image"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".inf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-inf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ini":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ini"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".jar":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-jar"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".java":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-java"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".jpe":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-jpe"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".jpeg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-jpeg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".jpg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-jpg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".js":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-js"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".json":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-json"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".jsp":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-jsp"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".jsx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-jsx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".key":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-key"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".lnk":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-lnk"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".log":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-log"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".lua":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-lua"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".m":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-m"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".m2v":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-m2v"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".m3u":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-m3u"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".m3u8":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-m3u8"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".m4a":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-m4a"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".m4v":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-m4v"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mdb":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mdb"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mdf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mdf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mid":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mid"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".midi":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-midi"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mkv":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mkv"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mobi":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mobi"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mod":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mod"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mov":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mov"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mp3":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mp3"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mp4":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mp4"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mpa":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mpa"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mpd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mpd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mpeg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mpeg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mpg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mpg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mpp":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mpp"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".mpt":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-mpt"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".msi":

                                            break;
                                        case ".nef":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-nef"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".nfo":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-nfo"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".nix":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-nix"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".odb":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-odb"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ods":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ods"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".odt":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-odt"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ogg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ogg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ost":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ost"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        case ".ott":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ott"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pcd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pcd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pdb":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pdb"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pem":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pem"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pfx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pfx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pgp":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pgp"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".php":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-php"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".png":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-png"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".potx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-potx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pps":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pps"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ppsx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ppsx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ppt":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ppt"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pptm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pptm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pptx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pptx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ps":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ps"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".psd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-psd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pst":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pst"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".pub":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-pub"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".rar":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-rar"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".resx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-resx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".rom":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-rom"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".rpm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-rpm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".rsa":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-rsa"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".rss":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-rss"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".rtf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-rtf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".sass":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-sass"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".scss":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-scss"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".sh":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-sh"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".sldm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-sldm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".sldx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-sldx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".sln":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-sln"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".sql":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-sql"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".sqlite":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-sqlite"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".step":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-step"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".stl":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-stl"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".svg":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-svg"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".swd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-swd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".swf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-swf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".sys":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-sys"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".tar":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-tar"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".tcsh":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-tcsh"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".tex":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-tex"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".tga":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-tga"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".tif":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-tif"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".tiff":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-tiff"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".tmp":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-tmp"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".torrent":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-torrent"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".tsv":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-tsv"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".ttf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-ttf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".txt":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-txt"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".udf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-udf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vb":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vb"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vbproj":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vbproj"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vbs":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vbs"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vcd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vcd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vcs":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vcs"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vdx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vdx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vob":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vob"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vsd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vsd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vss":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vss"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vst":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vst"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vsx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vsx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".vtx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-vtx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".war":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-war"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".wbk":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-wbk"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".webinfo":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-webinfo"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".webm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-webm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".webp":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-webp"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".wma":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-wma"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".wmf":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-wmf"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".wmv":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-wmv"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xaml":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xaml"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xlm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xlm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xlsm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xlsm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xlsx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xlsx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xlt":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xlt"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xltm":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xltm"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xltx":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xltx"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xml":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xml"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xsd":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xsd"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".xz":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-xz"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".yaml":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-yaml"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".yml":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-yml"></i> @attach_second_lst[i] </a></td>
                                            break;
                                        case ".zip":
                                            <td><a href=@attach_second_lst_links[i]><i class="fiv-cla fiv-icon-zip"></i> @attach_second_lst[i] </a></td>
                                            break;

                                        default:
                                            <td><a href=@attach_second_lst_links[i]><i class="bx bx-save">@attach_second_lst[i]</i> </a></td>
                                            break;

                                    }
                                    <td><button type="button" class="btn btn-danger btn-inverse" @onclick="()=>DeleteSecondAttachment(temp)"> х </button></td>

                                </tr>
                            }

                        </table>

                        @if (file_second_fileName != "")
                        {

                            <p></p>
                            <p><b><i class="bx bx-buoy bx-spin text-primary display-3"></i> Файл загружается, пожалуйста ожидайте... </b></p>

                            @file_second_fileName
                            <p>
                                <progress value="@file_second_UploadedBytes" max="@file_second_Size"></progress>
                                @(" ") @file_second_UploadedPercentage.ToString("F1") @("% ")
                                @FormatBytes(file_second_UploadedBytes) @(" / ") @FormatBytes(file_second_Size);
                            </p>
                        }


                    </div>
                    </div>
                    @if (operationType == "VIEW")
                    {

                    }
                    else
                    {
                    <InputFile OnChange="@LoadFilesSecondAttachments" multiple  class="form-control col-lg-12" />
                    }
                }
            </div>


            <div class="modal-footer">
                @switch (operationType)
                {
                    case "CREATE":
                        <button type="button" class="btn btn-primary" @onclick=@ModalSave>Создать</button>
                        <button type="button" class="btn" @onclick="@ModalCancel">Закрыть</button>
                        break;
                    case "EDIT":
                        <button type="button" class="btn btn-success" @onclick=@ModalSaveChanges>Сохранить изменения</button>
                        <button type="button" class="btn btn-danger" @onclick=@ModalDelete>Удалить оценку</button>
                        <button type="button" class="btn" @onclick="@ModalCancel">Закрыть</button>
                        break;
                    case "VIEW":
                        <button type="button" class="btn" @onclick="@ModalCancel">Закрыть</button>
                        break;
                }
            </div>
        </div>
    </div>
</div>



@code {

    [Parameter]
    public string user_fullname {get;set;}

    [Parameter]
    public string operationType { get; set; }

    [Parameter]
    public schema_marks mcm { get; set; }

    [Parameter]
    public EventCallback<schema_marks> OnCreate { get; set; }

    [Parameter]
    public EventCallback<schema_marks> OnUpdate { get; set; }

    [Parameter]
    public EventCallback<bool> OnClose { get; set; }

    [Parameter]
    public EventCallback<schema_marks> OnDelete { get; set; }

    [Parameter]
    public schema_users user_model { get; set; }

}

@functions {

    string file_first_fileName { get; set; }
    long file_first_UploadedPercentage { get; set; }
    long file_first_Size { get; set; }
    long file_first_UploadedBytes { get; set; }

    string file_second_fileName { get; set; }
    long file_second_UploadedPercentage { get; set; }
    long file_second_Size { get; set; }
    long file_second_UploadedBytes { get; set; }

    private List<IBrowserFile> loadedFiles = new();
    private long maxFileSize = 1024 * 15 * 1024;
    private int maxAllowedFiles = 100;
    private bool isLoading;

    bool isFileLoaded { get; set; }

    List<string> attach_first_lst = new List<string>();
    List<string> attach_first_lst_links = new List<string>();

    List<string> attach_second_lst = new List<string>();
    List<string> attach_second_lst_links = new List<string>();



    string getUnicalFileName(string filename_we, string extension)
    {
        string guid_str = Guid.NewGuid().ToString();
        return (filename_we + "_" + Path.GetRandomFileName() + extension);
    }

    List<string> _attachments = new List<string>();

    string FormatBytes(long value)
       => ByteSize.FromBytes(value).ToString("fi2", CultureInfo.CurrentCulture);

    record FileUploadProgress(string FileName, long Size)
    {
        public long UploadedBytes { get; set; }
        public double UploadedPercentage => (double)UploadedBytes / (double)Size * 100d;
    }

    bool _uploading;
    string echo;

    async Task OnInputFileChange(InputFileChangeEventArgs e, string unique_filename, int FileNumber)
    {
        await using var timer = new Timer(_ => InvokeAsync(() => StateHasChanged()));
        timer.Change(TimeSpan.FromMilliseconds(500), TimeSpan.FromMilliseconds(500));

        const long CHUNKSIZE = 1024 * 400;

        IBrowserFile file = null;

        if (e.FileCount > 1)
        {
            int file_c = 0;
            var file_dump_col = e.GetMultipleFiles(e.FileCount);
            foreach (IBrowserFile file_in in file_dump_col)
            {
                if (file_c == FileNumber)
                {
                    file = file_dump_col[file_c];
                }
                file_c++;
            }
        }
        else
        {
            file = e.File;
        }

        long uploadedBytes = 0;
        long totalBytes = file.Size;
        long percent = 0;
        int fragment = 0;
        long chunkSize;

        var clientlocal = ClientFactory.CreateClient("LocalApi");

        using (var inStream = file.OpenReadStream(long.MaxValue))
        {
            _uploading = true;
            while (_uploading)
            {
                try
                {
                    chunkSize = CHUNKSIZE;
                    if (uploadedBytes + CHUNKSIZE > totalBytes)
                    {// remainder
                        chunkSize = totalBytes - uploadedBytes;
                    }
                    var chunk = new byte[chunkSize];
                    await inStream.ReadAsync(chunk, 0, chunk.Length);
                    // upload this fragment
                    using var formFile = new MultipartFormDataContent();
                    var fileContent = new StreamContent(new MemoryStream(chunk));
                    formFile.Add(fileContent, "file", unique_filename);
                    // post

                    var response = await clientlocal.PostAsync($"api/MarksChart2/{fragment++}", formFile);
                    // Update our progress data and UI
                    uploadedBytes += chunkSize;
                    percent = uploadedBytes * 100 / totalBytes;

                    file_first_UploadedPercentage = percent;
                    file_first_Size = totalBytes;
                    file_first_UploadedBytes = uploadedBytes;
                    file_first_fileName = file.Name;

                    echo = $"Uploaded {percent}%  {uploadedBytes} of {totalBytes} | Fragment: {fragment}";
                    if (percent >= 100)
                    {// upload complete
                        _uploading = false;
                        file_first_UploadedPercentage = 0;
                        file_first_Size = 0;
                        file_first_UploadedBytes = 0;
                        file_first_fileName = "";
                    }
                    await InvokeAsync(StateHasChanged);
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.Message);
                }
            }
        }
    }

    async Task OnSecondInputFileChange(InputFileChangeEventArgs e, string unique_filename, int FileNumber)
    {
        await using var timer = new Timer(_ => InvokeAsync(() => StateHasChanged()));
        timer.Change(TimeSpan.FromMilliseconds(500), TimeSpan.FromMilliseconds(500));

        const long CHUNKSIZE = 1024 * 400;

        IBrowserFile file = null;

        if (e.FileCount > 1)
        {
            int file_c = 0;
            var file_dump_col = e.GetMultipleFiles(e.FileCount);
            foreach (IBrowserFile file_in in file_dump_col)
            {
                if (file_c == FileNumber)
                {
                    file = file_dump_col[file_c];
                }
                file_c++;
            }
        }
        else
        {
            file = e.File;
        }

        long uploadedBytes = 0;
        long totalBytes = file.Size;
        long percent = 0;
        int fragment = 0;
        long chunkSize;

        var clientlocal = ClientFactory.CreateClient("LocalApi");

        using (var inStream = file.OpenReadStream(long.MaxValue))
        {
            _uploading = true;
            while (_uploading)
            {
                try
                {
                    chunkSize = CHUNKSIZE;
                    if (uploadedBytes + CHUNKSIZE > totalBytes)
                    {// remainder
                        chunkSize = totalBytes - uploadedBytes;
                    }
                    var chunk = new byte[chunkSize];
                    await inStream.ReadAsync(chunk, 0, chunk.Length);
                    // upload this fragment
                    using var formFile = new MultipartFormDataContent();
                    var fileContent = new StreamContent(new MemoryStream(chunk));
                    formFile.Add(fileContent, "file", unique_filename);
                    // post

                    var response = await clientlocal.PostAsync($"api/MarksChart/{fragment++}", formFile);
                    // Update our progress data and UI
                    uploadedBytes += chunkSize;
                    percent = uploadedBytes * 100 / totalBytes;

                    file_second_UploadedPercentage = percent;
                    file_second_Size = totalBytes;
                    file_second_UploadedBytes = uploadedBytes;
                    file_second_fileName = file.Name;

                    echo = $"Uploaded {percent}%  {uploadedBytes} of {totalBytes} | Fragment: {fragment}";
                    if (percent >= 100)
                    {// upload complete
                        _uploading = false;
                        file_second_UploadedPercentage = 0;
                        file_second_Size = 0;
                        file_second_UploadedBytes = 0;
                        file_second_fileName = "";
                    }
                    await InvokeAsync(StateHasChanged);
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.Message);
                }
            }
        }
    }

    private async Task LoadFilesAttachments(InputFileChangeEventArgs e)
    {
        string filename = "";
        isLoading = true;
        loadedFiles.Clear();

        int file_num = -1;

        foreach (var file in e.GetMultipleFiles(maxAllowedFiles))
        {
            file_num++;
            try
            {
                loadedFiles.Add(file);
                filename = file.Name;
                filename=SupressSpaces(filename);
                var trustedFileNameForFileStorage = Path.GetRandomFileName();
                var path = Path.Combine(_env.ContentRootPath, "wwwroot", "uploads", "markschart", filename);

                if (System.IO.File.Exists(Path.Combine(_env.ContentRootPath, "wwwroot", "uploads", "markschart", filename)) || filename.Length > 100)
                {
                    string filename_we = Path.GetFileNameWithoutExtension(file.Name);
                    string extension = Path.GetExtension(file.Name);
                    filename = getUnicalFileName(filename_we, extension);
                    filename=SupressSpaces(filename);
                }

               sc.Log("MarksChart", "Начинается загрузка файла '" + filename + "'", SystemCore.LogLevels.Info);

                if (file.Size > maxFileSize)
                {
                     sc.Log("MarksChart", "Файл слишком большой, поэтому инициализирую загрузку большого файла '" + filename + "'", SystemCore.LogLevels.Debug);
                    await OnInputFileChange(e, filename, file_num);
                }
                else
                {
                    await using FileStream fs = new(path, FileMode.Create);
                    await file.OpenReadStream(maxFileSize).CopyToAsync(fs);
                    _attachments.Add("https://evicrm.store/uploads/markschart/" + filename);
                }
            }
            catch (Exception ex)
            {
                    sc.Log("MarksChart", "Ошибка при загрузке файла '" + filename + "', " + ex.Message, SystemCore.LogLevels.Error);
                     sc.Syslog(_iwebhost, user_model.login, "Дневник", $"Произошла ошибка при загрузке файла: {filename}", SystemCore.LogLevels.Info);
            }
            finally
            {
                attach_first_lst.Add(filename);
                attach_first_lst_links.Add("https://evicrm.store/uploads/markschart/" + filename);
                sc.Log("MarksChart", "Загружен файл '" + filename + "'", SystemCore.LogLevels.Info);
                sc.Syslog(_iwebhost, user_model.login, "Дневник", $"Загрузил файл к оценке: {filename}", SystemCore.LogLevels.Info);
                StateHasChanged();
            }
        }
    }

    string SupressSpaces(string filename)
    {
        if (filename.Contains(" "))
        {
            filename = filename.Replace(" ","_");
        }
        return filename;
    }

     private async Task LoadFilesSecondAttachments(InputFileChangeEventArgs e)
    {
        string filename = "";
        isLoading = true;
        loadedFiles.Clear();

        int file_num = -1;

        foreach (var file in e.GetMultipleFiles(maxAllowedFiles))
        {
            file_num++;
            try
            {
                loadedFiles.Add(file);
                filename = file.Name;
                filename=SupressSpaces(filename);
                var trustedFileNameForFileStorage = Path.GetRandomFileName();
                var path = Path.Combine(_env.ContentRootPath, "wwwroot", "uploads", "markschart", filename);

                if (System.IO.File.Exists(Path.Combine(_env.ContentRootPath, "wwwroot", "uploads", "markschart", filename)) || filename.Length > 100)
                {
                    string filename_we = Path.GetFileNameWithoutExtension(file.Name);
                    string extension = Path.GetExtension(file.Name);
                    filename = getUnicalFileName(filename_we, extension);
                    filename=SupressSpaces(filename);
                }

               sc.Log("MarksChart", "Начинается загрузка файла '" + filename + "'", SystemCore.LogLevels.Info);

                if (file.Size > maxFileSize)
                {
                     sc.Log("MarksChart", "Файл слишком большой, поэтому инициализирую загрузку большого файла '" + filename + "'", SystemCore.LogLevels.Debug);
                    await OnInputFileChange(e, filename, file_num);
                }
                else
                {
                    await using FileStream fs = new(path, FileMode.Create);
                    await file.OpenReadStream(maxFileSize).CopyToAsync(fs);
                    _attachments.Add("https://evicrm.store/uploads/markschart/" + filename);
                }
            }
            catch (Exception ex)
            {
                    sc.Log("MarksChart", "Ошибка при загрузке файла '" + filename + "', " + ex.Message, SystemCore.LogLevels.Error);
                     sc.Syslog(_iwebhost, user_model.login, "Дневник", $"Произошла ошибка при загрузке файла: {filename}", SystemCore.LogLevels.Info);
            }
            finally
            {
                attach_second_lst.Add(filename);
                attach_second_lst_links.Add("https://evicrm.store/uploads/markschart/" + filename);
                sc.Log("MarksChart", "Загружен файл '" + filename + "'", SystemCore.LogLevels.Info);
                sc.Syslog(_iwebhost, user_model.login, "Дневник", $"Загрузил файл к оценке: {filename}", SystemCore.LogLevels.Info);
                StateHasChanged();
            }
        }
    }

    private Task ModalCancel()
    {
        return OnClose.InvokeAsync(false);
    }

    protected async override Task OnInitializedAsync()
    {
        if (operationType == "CREATE")
        {
            attach_first_lst.Clear();
            attach_second_lst.Clear();
            attach_first_lst_links.Clear();
            attach_second_lst_links.Clear();

        }
        else
        {
            attach_first_lst = bc.getMultipleStringDecodingString(mcm.firstAttachments);
            foreach (string att_lnk in attach_first_lst)
            {
                attach_first_lst_links.Add("https://evicrm.store/uploads/markschart/" + att_lnk);
            }

            attach_second_lst = bc.getMultipleStringDecodingString(mcm.secondAttachments);
            foreach (string att_lnk in attach_second_lst)
            {
                attach_second_lst_links.Add("https://evicrm.store/uploads/markschart/" + att_lnk);
            }
        }

        file_first_fileName = "";
        file_first_UploadedPercentage = 0;
        file_first_Size = 0;
        file_first_UploadedBytes = 0;

        file_second_fileName = "";
        file_second_UploadedPercentage = 0;
        file_second_Size = 0;
        file_second_UploadedBytes = 0;

        StateHasChanged();
    }

    private Task ModalSaveChanges()
    {
        mcm.firstAttachments= bc.getMultipleStringEncodingString(attach_first_lst);
        mcm.secondAttachments= bc.getMultipleStringEncodingString(attach_second_lst);
        OnUpdate.InvokeAsync(mcm);
        return OnClose.InvokeAsync(true);
    }

    private Task ModalSave()
    {
        OnCreate.InvokeAsync(mcm);
        return OnClose.InvokeAsync(true);
    }

    private Task ModalDelete()
    {
        OnDelete.InvokeAsync(mcm);
        return OnClose.InvokeAsync(true);
    }


}