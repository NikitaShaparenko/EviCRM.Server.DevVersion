@using Blazorise
@using EviCRM.Server.ViewModels
@using Majorsoft.Blazor.Components.Tabs
@using System.Net.Sockets
@using System.Globalization
@using Blazored.TextEditor
@using Blazorise.RichTextEdit

@using Majorsoft.Blazor.Components.Notifications
@using Meziantou.Framework

@inject IJSRuntime jsr
@inject IWebHostEnvironment _env
@inject HttpClient _httpClient
@inject IHttpClientFactory ClientFactory

@inject NavigationManager UriHelper
@inject IWebHostEnvironment _env
@inject ILocalStorageService _localStorageService
@inject ISessionStorageService _sessionStorageService

@inject Context _context
@inject BackendController bc


<style>
    .wordwrap {
        word-wrap: break-word; /* Перенос слов */
    }

    .modal-dialog {
        overflow-y: initial !important
    }

    .modal-body {
        max-height: calc(100vh - 200px);
        overflow-y: auto;
    }

    .container {
        border: 1px solid #000000;
        height: 300px;
    }

        .container textarea {
            border: 1px solid red;
            height: 100%;
        }
</style>


<TabsPanel @ref="_tabs"
           ActiveColor="@_activeColor"
           InactiveColor="@_inactiveColor"
           HoverColor="@_hoverColor"
           ActiveTab="@_activeTab"
           TabItemsHeight="@_height"
           TabItemsWidth="@_width"
           Disabled="@_allTabsDisabled"
           TabPositon="@_tabPositon"
           Animate="@_isAnimated"
           OnTabChanged="OnTabChanged">
    <TabItems>

        @if (Current_Task.task_status != "failed" && Current_Task.task_status != "canceled" && Current_Task.task_status != "completed") //Отсекаем закрытую задачу
        {
            @if (isAdmin || (!isAdmin && (global_personal_status == "approved" || global_personal_status == "pending" || global_personal_status == "delayed"))) //Отсекаем невозможность выбора
            {

                if (!isAdmin || (isAdmin && isTaskContainsSelf()))
                {

                    //Commit
                    <TabItem id="_tab1" @ref="_tab1" Disabled="false" Hidden="false">
                        <Header><strong>Новые изменения</strong></Header>
                        <Content>
                            <div class="form-group row mb-4">
                                <label for="ttm_commit_title" class="col-form-label col-lg-2">Краткое изложение</label>
                                <div class="col-lg-10">
                                    <input id="ttm_commit_title" name="ttm_commit_title" @bind=@ttm_commit_title type="text" placeholder="Введите краткое изложение изменений" class="form-control">
                                </div>
                            </div>

                            <div class="form-group row mb-4">
                                <label for="ttm_commit_body" class="col-form-label col-lg-2">Что изменилось?</label>
                                <div class="col-lg-10">

                                    <RichTextEdit @ref="rtfCommit"
                                      Theme="RichTextEditTheme.Snow"
                                      ContentChanged="@OnContentChanged_rtfCommit"
                                      PlaceHolder="Введите текст изменений"
                                      ReadOnly="@readOnly"
                                      SubmitOnEnter="false"
                                      EnterPressed="@OnSave"
                                      ToolbarPosition="Placement.Top">
                                        <Editor>Изменилось:</Editor>
                                        <Toolbar>
                                            <RichTextEditToolbarGroup>
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Bold" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Italic" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Align" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Blockquote" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Header" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Strike" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Underline" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Align" />

                                                <RichTextEditToolbarSelect Action="RichTextEditAction.Size">
                                                    <RichTextEditToolbarSelectItem Value="small" />
                                                    <RichTextEditToolbarSelectItem Selected />
                                                    <RichTextEditToolbarSelectItem Value="large" />
                                                    <RichTextEditToolbarSelectItem Value="huge">Very Big</RichTextEditToolbarSelectItem>
                                                </RichTextEditToolbarSelect>
                                                <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="ordered" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="bullet" />
                                            </RichTextEditToolbarGroup>
                                            <!-- Custom toolbar content -->
                                <RichTextEditToolbarGroup Float="Float.End">
                                                <!-- <Button onClick="window.open('https://www.quilljs.com/','quilljs')"><Icon Name="IconName.InfoCircle" /></Button> -->
                                    <Button Clicked="@OnSave"><Icon Name="IconName.Save" /></Button>
                                            </RichTextEditToolbarGroup>
                                        </Toolbar>
                                    </RichTextEdit>
                                </div>
                            </div>
                            <p></p>
                            <p></p>
                            <p></p>


                            <div class="form-group row mb-4">
                                <label for="ttm_cast_coauthors" class="col-form-label col-lg-2">Совместно с исполнителями</label>
                                <div class="col-lg-10">

                                    <Havit.Blazor.Components.Web.Bootstrap.HxMultiSelect Label="Список исполнителей"
                                                                             TItem="@SelectData"
                                                                             TValue="string"
                                                                             Data="@select_data_personal"
                                                                             @bind-Value="@SelectedValues_ttm_commit_personal"
                                                                             TextSelector="@((p) => p.Name)"
                                                                             ValueSelector="@((p) => p.Id)"
                                                                             EmptyText="Выберите одно или несколько значений"
                                                                             NullDataText="Загружаются значения..." />
                                </div>

                            </div>

                            <div class="form-group row mb-4">
                                <label for="ttm_cast_coauthors" class="col-form-label col-lg-2">Совместно с отделами</label>
                                <div class="col-lg-10">

                                    <Havit.Blazor.Components.Web.Bootstrap.HxMultiSelect Label="Список отделов"
                                                                             TItem="@SelectData"
                                                                             TValue="string"
                                                                             Data="@select_data_divs"
                                                                             @bind-Value="@SelectedValues_ttm_commit_divs"
                                                                             TextSelector="@((p) => p.Name)"
                                                                             ValueSelector="@((p) => p.Id)"
                                                                             EmptyText="Выберите одно или несколько значений"
                                                                             NullDataText="Загружаются значения..." />
                                </div>

                            </div>

                            <button type="button" @onclick="(async() => await post_commit())" class="btn btn-success waves-effect waves-light">Сохранить изменения</button>

                        </Content>
                    </TabItem>

                            //Attachments
                    <TabItem id="_tab1" @ref="_tab2" Disabled="false" Hidden="false">
                        <Header><strong>Отправить файл</strong></Header>
                        <Content>
                            <div class="form-group row mb-4">
                                <label for="ttm_sendattachments_body" class="col-form-label col-lg-2">Описание вложений:</label>
                                <div class="col-lg-10">

                                    <RichTextEdit @ref="rtfSenderFile"
                                      Theme="RichTextEditTheme.Snow"
                                      ContentChanged="@OnContentChanged_rtfSenderFile"
                                      PlaceHolder="Введите текст изменений"
                                      ReadOnly="@readOnly"
                                      SubmitOnEnter="false"
                                      EnterPressed="@OnSave"
                                      ToolbarPosition="Placement.Bottom">
                                        <Editor></Editor>
                                        <Toolbar>
                                            <RichTextEditToolbarGroup>
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Bold" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Italic" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Align" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Blockquote" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Header" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Strike" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Underline" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Align" />

                                                <RichTextEditToolbarSelect Action="RichTextEditAction.Size">
                                                    <RichTextEditToolbarSelectItem Value="small" />
                                                    <RichTextEditToolbarSelectItem Selected />
                                                    <RichTextEditToolbarSelectItem Value="large" />
                                                    <RichTextEditToolbarSelectItem Value="huge">Very Big</RichTextEditToolbarSelectItem>
                                                </RichTextEditToolbarSelect>
                                                <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="ordered" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="bullet" />
                                            </RichTextEditToolbarGroup>
                                            <!-- Custom toolbar content -->
                                <RichTextEditToolbarGroup Float="Float.End">
                                                <Button Clicked="@OnSave"><Icon Name="IconName.Save" /></Button>
                                            </RichTextEditToolbarGroup>
                                        </Toolbar>
                                    </RichTextEdit>
                                </div>
                            </div>
                            <p></p>
                            <p></p>
                            <p></p>

                            <div class="form-group row mb-4">
                                <label for="ttm_info_body" class="col-form-label col-lg-2">Приложенные файлы:</label>
                                <div class="col-lg-10">
                                    <p><h6>Приложенные файлы</h6></p>

                                    <InputFile OnChange="@LoadFilesAttachments" multiple="multiple" class="form-control" />

                                    <p></p>
                                    <table>

                                        <tr>
                                            <th scope="col" style="width: 70px;">#</th>
                                            <th scope="col">Файл</th>
                                            <th scope="col" style="width: 150px;"> </th>
                                        </tr>
                                        @for (int i = 0; i < attach_lst.Count; i++)
                                        {
                                            string extension = Path.GetExtension(attach_lst[i]);
                                            int temp = i;
                                            <tr>
                                                <td>@(i+1))</td>

                                                @switch (extension)
                                                {
                                                    case ".xls":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xls"></i> @attach_lst[i]</a></td>
                                                        break;

                                                    case ".pdf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pdf"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".wav":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-wav"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".7z":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-7z"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".aac":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-aac"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".accdb":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-accdb"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".accdt":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-accdt"></i> @attach_lst[i]  </a></td>
                                                        break;

                                                    case ".amr":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-amr"></i> @attach_lst[i]  </a></td>
                                                        break;

                                                    case ".apk":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-apk"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".app":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-app"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".asax":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-asax"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".asc":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-asc"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".ash":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ash"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".ashx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ashx"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".asp":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-asp"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".aspx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-aspx"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".avi":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-avi"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".axd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-axd"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".bash":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-bash"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".bat":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-bat"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".bin":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-bin"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".bmp":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-bmp"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".bpg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-bpg"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".bz2":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-bz2"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".c":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-c"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".cab":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cab"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".cad":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cad"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".caf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-caf"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".cal":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cal"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".cd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cd"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".cer":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cer"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cfg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cfg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cfm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cfm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cfml":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cfml"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cgi":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cgi"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".class":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-class"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cmd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cmd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".coffee":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-coffee"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".com":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-com"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".conf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-conf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cpp":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cpp"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".crdownload":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-crdownload"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cs":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cs"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".csh":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-csh"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cson":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cson"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".csproj":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-csproj"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".css":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-css"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".csv":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-csv"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".cue":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-cue"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dat":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dat"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".db":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-db"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dbf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dbf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".deb":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-deb"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dgn":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dgn"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dist":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dist"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".diz":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-diz"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dll":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dll"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dmg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dmg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dng":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dng"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".doc":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-doc"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".docb":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-docb"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".docm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-docm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".docx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-docx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dot":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dot"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dotm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dotm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dotx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dotx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".download":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-download"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dpj":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dpj"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dtd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dtd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dwg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dwg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".dxf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-dxf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".exe":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-exe"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".f4v":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-f4v"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".fax":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-fax"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".fb2":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-fb2"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".fla":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-fla"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".flac":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-flac"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".flv":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-flv"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".gif":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-gif"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".gpg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-gpg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".gz":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-gz"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".h":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-h"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".heic":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-heic"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".htm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-htm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".html":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-html"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ico":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ico"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ics":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ics"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".iff":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-iff"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ifo":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ifo"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".image":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-image"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".inf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-inf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ini":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ini"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".jar":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-jar"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".java":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-java"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".jpe":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-jpe"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".jpeg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-jpeg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".jpg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-jpg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".js":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-js"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".json":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-json"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".jsp":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-jsp"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".jsx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-jsx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".key":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-key"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".lnk":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-lnk"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".log":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-log"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".lua":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-lua"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".m":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-m"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".m2v":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-m2v"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".m3u":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-m3u"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".m3u8":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-m3u8"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".m4a":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-m4a"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".m4v":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-m4v"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mdb":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mdb"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mdf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mdf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mid":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mid"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".midi":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-midi"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mkv":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mkv"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mobi":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mobi"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mod":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mod"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mov":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mov"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mp3":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mp3"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mp4":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mp4"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mpa":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mpa"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mpd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mpd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mpeg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mpeg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mpg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mpg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mpp":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mpp"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".mpt":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-mpt"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".msi":

                                                        break;
                                                    case ".nef":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-nef"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".nfo":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-nfo"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".nix":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-nix"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".odb":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-odb"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ods":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ods"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".odt":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-odt"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ogg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ogg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ost":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ost"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    case ".ott":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ott"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pcd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pcd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pdb":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pdb"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pem":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pem"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pfx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pfx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pgp":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pgp"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".php":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-php"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".png":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-png"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".potx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-potx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pps":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pps"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ppsx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ppsx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ppt":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ppt"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pptm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pptm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pptx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pptx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ps":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ps"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".psd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-psd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pst":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pst"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".pub":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-pub"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".rar":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-rar"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".resx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-resx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".rom":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-rom"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".rpm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-rpm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".rsa":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-rsa"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".rss":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-rss"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".rtf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-rtf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".sass":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-sass"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".scss":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-scss"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".sh":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-sh"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".sldm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-sldm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".sldx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-sldx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".sln":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-sln"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".sql":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-sql"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".sqlite":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-sqlite"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".step":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-step"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".stl":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-stl"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".svg":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-svg"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".swd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-swd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".swf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-swf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".sys":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-sys"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".tar":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-tar"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".tcsh":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-tcsh"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".tex":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-tex"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".tga":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-tga"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".tif":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-tif"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".tiff":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-tiff"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".tmp":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-tmp"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".torrent":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-torrent"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".tsv":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-tsv"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".ttf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-ttf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".txt":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-txt"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".udf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-udf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vb":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vb"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vbproj":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vbproj"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vbs":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vbs"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vcd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vcd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vcs":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vcs"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vdx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vdx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vob":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vob"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vsd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vsd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vss":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vss"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vst":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vst"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vsx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vsx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".vtx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-vtx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".war":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-war"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".wbk":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-wbk"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".webinfo":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-webinfo"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".webm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-webm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".webp":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-webp"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".wma":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-wma"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".wmf":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-wmf"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".wmv":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-wmv"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xaml":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xaml"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xlm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xlm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xlsm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xlsm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xlsx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xlsx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xlt":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xlt"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xltm":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xltm"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xltx":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xltx"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xml":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xml"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xsd":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xsd"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".xz":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-xz"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".yaml":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-yaml"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".yml":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-yml"></i> @attach_lst[i] </a></td>
                                                        break;
                                                    case ".zip":
                                                        <td><a href=@attach_lst_links[i]><i class="fiv-cla fiv-icon-zip"></i> @attach_lst[i] </a></td>
                                                        break;

                                                    default:
                                                        <td><a href=@attach_lst_links[i]><i class="bx bx-save">@attach_lst[i]</i> </a></td>
                                                        break;

                                                }
                                                <td><button type="button" class="btn btn-danger btn-inverse" @onclick="async()=> await DeleteAttachment(temp)"> х </button></td>

                                            </tr>
                                        }

                                    </table>

                                    @if (file_fileName != "")
                                    {

                                        <p></p>
                                        <p><b>Файл загружается, пожалуйста ожидайте...</b> </p>

                                        @file_fileName
                                        <p>
                                            <progress value="@file_UploadedBytes" max="@file_Size"></progress>
                                            @(" ") @file_UploadedPercentage.ToString("F1") @("% ")
                                            @FormatBytes(file_UploadedBytes) @(" / ") @FormatBytes(file_Size);
                                        </p>
                                    }

                                </div>

                                <!-- </div>-->




                </div>
                            <button type="button" class="btn btn-success waves-effect waves-light" @onclick="async() => await post_attachments()">Отправить файлы</button>
                        </Content>
                    </TabItem>

                            //Task Actions
                    <TabItem id="_tab3" @ref="_tab3" Disabled="false" Hidden="false">
                        <Header><strong>Действия с задачей</strong></Header>
                        <Content>
                            <div class="row">
                                <div class="col-lg-4">
                            <ul>
                                <p>
                                <li><button type="button" class="btn btn-danger waves-effect waves-light" @onclick="@modal_finishTaskOpen">Отчитаться о выполнении задачи</button></li></p>

                                @if (modal_finishTaskOpened)
                                {
                                    <TaskTrackingModal_FinishTask
                                    Current_Task=Current_Task
                                    Divisions=Divisions
                                    Users=Users
                                                  personal_status=@personal_status
                                                  personal_status_arg1=@personal_status_arg1
                                                  personal_status_arg2=@personal_status_arg2
                                                  OnClose=@OnCloseFinishTask
                                                  datetime_end=@Current_Task.task_enddate
                                                  task_author=@Current_Task.task_author
                                                  task_id=@Current_Task.id.ToString() />
                                }

                                <p>
                                <li><button type="button" class="btn btn-danger waves-effect waves-light" @onclick="@modal_RefuseDoingOpen">Отказываюсь выполнять задачу</button></li></p>

                                @if (modal_RefuseDoingOpened)
                                {
                                    <TaskTracking_RefuseDoing
                                    Current_Task=Current_Task
                                    Divisions=Divisions
                                    Users=Users
                                              OnClose=@OnCloseRefuseDoing
                                              task_author=@Current_Task.task_author
                                              task_id=@Current_Task.id.ToString() />
                                }

                                <p>
                                <li><button type="button" class="btn btn-danger waves-effect waves-light" @onclick="@modal_DelayOpen">Запрос о переносе сроков</button></li></p>

                                @if (modal_DelayOpened)
                                {
                                    <TaskTracking_Delay
                                    Current_Task=Current_Task
                                    Divisions=Divisions
                                    Users=Users
                                        OnClose=@OnCloseDelay
                                        task_author=@Current_Task.task_author
                                        task_id=@Current_Task.id.ToString() />
                                }
                                </ul>
                                </div>

                                <div class="col-lg-4">
                            <ul>
                                <p>
                                <li><button type="button" class="btn btn-danger waves-effect waves-light" @onclick="Extra_AddNews">Добавить новость</button></li></p>

                                 <p>
                                <li><button type="button" class="btn btn-danger waves-effect waves-light" @onclick="Extra_AddMaps">Добавить точку с карты</button></li></p>

                                 <p>
                                <li><button type="button" class="btn btn-danger waves-effect waves-light" @onclick="Extra_AddFile">Добавить файл с хранилища</button></li></p>


                            </ul>
                                </div>
                                </div>
                        </Content>
                    </TabItem>
                }


                @*//Админская часть*@

                @if (isAdmin)
                {
                    //Warning
                    <TabItem id="_tab4" @ref="_tab4" Disabled="false" Hidden="false">
                        <Header><strong>Вынести предупреждение</strong></Header>
                        <Content>
                            <div class="form-group row mb-4">
                                <label for="ttm_cast_coauthors" class="col-form-label col-lg-2">Вынести предупреждение исполнителям</label>

                                <div class="col-lg-10">
                                    <p>
                                        <Havit.Blazor.Components.Web.Bootstrap.HxMultiSelect Label="Список исполнителей"
                                                                                 TItem="@SelectData"
                                                                                 TValue="string"
                                                                                 Data="@select_data_personal"
                                                                                 @bind-Value="SelectedValues_rtfWarningWhom_personal"
                                                                                 TextSelector="@((p) => p.Name)"
                                                                                 ValueSelector="@((p) => p.Id)"
                                                                                 EmptyText="Выберите одно или несколько значений"
                                                                                 NullDataText="Загружаются значения..." />
                                    </p>
                                </div>

                            </div>

                            <div class="form-group row mb-4">
                                <label for="ttm_cast_coauthors" class="col-form-label col-lg-2">Вынести предупреждение отделам</label>

                                <div class="col-lg-10">
                                    <p>
                                        <Havit.Blazor.Components.Web.Bootstrap.HxMultiSelect Label="Список отделов"
                                                                                 TItem="@SelectData"
                                                                                 TValue="string"
                                                                                 Data="@select_data_divs"
                                                                                 @bind-Value="@SelectedValues_rtfWarningWhom_divs"
                                                                                 TextSelector="@((p) => p.Name)"
                                                                                 ValueSelector="@((p) => p.Id)"
                                                                                 EmptyText="Выберите одно или несколько значений"
                                                                                 NullDataText="Загружаются значения..." />
                                    </p>
                                </div>

                            </div>

                            <p>
                                <div class="form-group row mb-4">
                                    <label for="ttm_warning_title" class="col-form-label col-lg-2">Заголовок предупреждения:</label>
                                    <div class="col-lg-10">
                                        <input id="ttm_warning_title" @bind=@ttm_warning_title type="text" placeholder="Введите заголовок предупреждения" class="form-control">
                                    </div>
                                </div>
                            </p>
                            <p>
                                <div class="form-group row mb-4">
                                    <label for="ttm_info_body" class="col-form-label col-lg-2">Текст предупреждения:</label>
                                    <div class="col-lg-10">

                                        <RichTextEdit @ref="rtfWarning"
                                          Theme="RichTextEditTheme.Snow"
                                          ContentChanged="@OnContentChanged_rtfWarning"
                                          PlaceHolder="Введите текст изменений"
                                          ReadOnly="@readOnly"
                                          SubmitOnEnter="false"
                                          EnterPressed="@OnSave"
                                          ToolbarPosition="Placement.Top">
                                            <Editor>Предупреждение:</Editor>
                                            <Toolbar>
                                                <RichTextEditToolbarGroup>
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Bold" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Italic" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Align" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Blockquote" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Header" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Strike" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Underline" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Align" />

                                                    <RichTextEditToolbarSelect Action="RichTextEditAction.Size">
                                                        <RichTextEditToolbarSelectItem Value="small" />
                                                        <RichTextEditToolbarSelectItem Selected />
                                                        <RichTextEditToolbarSelectItem Value="large" />
                                                        <RichTextEditToolbarSelectItem Value="huge">Very Big</RichTextEditToolbarSelectItem>
                                                    </RichTextEditToolbarSelect>
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="ordered" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="bullet" />
                                                </RichTextEditToolbarGroup>
                                                <!-- Custom toolbar content -->
                                    <RichTextEditToolbarGroup Float="Float.End">
                                                    <Button Clicked="@OnSave"><Icon Name="IconName.Save" /></Button>
                                                </RichTextEditToolbarGroup>
                                            </Toolbar>
                                        </RichTextEdit>
                                    </div>


                                </div>
                                <!-- </div>-->

                </p>
                            <button type="button" class="btn btn-success waves-effect waves-light" @onclick="post_warning">Отправить предупреждение</button>
                        </Content>
                    </TabItem>

                    //Question
                    <TabItem id="_tab5" @ref="_tab5" Disabled="false" Hidden="false">
                        <Header><strong>Задать вопрос</strong></Header>
                        <Content>
                            <div class="form-group row mb-4">
                                <label for="ttm_cast_coauthors_question" class="col-form-label col-lg-2">Задать вопрос работникам</label>


                                <div class="col-lg-10">
                                    <Havit.Blazor.Components.Web.Bootstrap.HxMultiSelect Label="Список работников"
                                                                             TItem="@SelectData"
                                                                             TValue="string"
                                                                             Data="@select_data_personal"
                                                                             @bind-Value="SelectedValues_ttm_question_whom_personal"
                                                                             TextSelector="@((p) => p.Name)"
                                                                             ValueSelector="@((p) => p.Id)"
                                                                             EmptyText="Выберите одно или несколько значений"
                                                                             NullDataText="Загружаются значения..." />
                                </div>

                            </div>
                            <p></p>

                            <div class="form-group row mb-4">
                                <label for="ttm_cast_coauthors_question_divs" class="col-form-label col-lg-2">Задать вопрос отделам</label>


                                <div class="col-lg-10">

                                    <Havit.Blazor.Components.Web.Bootstrap.HxMultiSelect Label="Список отделов"
                                                                             TItem="@SelectData"
                                                                             TValue="string"
                                                                             Data="@select_data_divs"
                                                                             @bind-Value="SelectedValues_ttm_message_whom_div"
                                                                             TextSelector="@((p) => p.Name)"
                                                                             ValueSelector="@((p) => p.Id)"
                                                                             EmptyText="Выберите одно или несколько значений"
                                                                             NullDataText="Загружаются значения..." />
                                </div>

                            </div>
                            <p>

                                <div class="form-group row mb-4">
                                    <label for="ttm_question_title" class="col-form-label col-lg-2">Заголовок вопроса:</label>
                                    <div class="col-lg-10">
                                        <input id="ttm_question_title" @bind="ttm_question_title" name="ttm_question_title" type="text" placeholder="Введите заголовок вопроса" class="form-control">
                                    </div>
                                </div>
                            </p>
                            <p>
                                <div class="form-group row mb-4">
                                    <label for="ttm_question_body" class="col-form-label col-lg-2">Текст вопроса:</label>
                                    <div class="col-lg-10">

                                        <RichTextEdit @ref="rtfQuestion"
                                          Theme="RichTextEditTheme.Snow"
                                          ContentChanged="@OnContentChanged_rtfQuestion"
                                          PlaceHolder="Введите текст вопроса"
                                          ReadOnly="@readOnly"
                                          SubmitOnEnter="false"
                                          EnterPressed="@OnSave"
                                          ToolbarPosition="Placement.Top">
                                            <Editor>Вопрос:</Editor>
                                            <Toolbar>
                                                <RichTextEditToolbarGroup>
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Bold" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Italic" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Align" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Blockquote" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Header" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Strike" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Underline" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.Align" />

                                                    <RichTextEditToolbarSelect Action="RichTextEditAction.Size">
                                                        <RichTextEditToolbarSelectItem Value="small" />
                                                        <RichTextEditToolbarSelectItem Selected />
                                                        <RichTextEditToolbarSelectItem Value="large" />
                                                        <RichTextEditToolbarSelectItem Value="huge">Very Big</RichTextEditToolbarSelectItem>
                                                    </RichTextEditToolbarSelect>
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="ordered" />
                                                    <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="bullet" />
                                                </RichTextEditToolbarGroup>
                                                <!-- Custom toolbar content -->
                                    <RichTextEditToolbarGroup Float="Float.End">
                                                    <Button Clicked="@OnSave"><Icon Name="IconName.Save" /></Button>
                                                </RichTextEditToolbarGroup>
                                            </Toolbar>
                                        </RichTextEdit>

                                    </div>
                                </div>
                            </p>

                            <button type="button" class="btn btn-success waves-effect waves-light" @onclick="post_question">Отправить вопрос</button>
                        </Content>
                    </TabItem>

                    //Message
                    <TabItem id="_tab6" @ref="_tab6" Disabled="false" Hidden="false">
                        <Header><strong>Опубликовать сообщение</strong></Header>
                        <Content>
                            <div class="form-group row mb-4">

                                <label for="ttm_cast_coauthors" class="col-form-label col-lg-2">Опубликовать сообщение исполнителям</label>
                                <div class="col-lg-10">
                                    <Havit.Blazor.Components.Web.Bootstrap.HxMultiSelect Label="Список исполнителей"
                                                                             TItem="@SelectData"
                                                                             TValue="string"
                                                                             Data="@select_data_personal"
                                                                             @bind-Value="SelectedValues_ttm_message_whom_personal"
                                                                             TextSelector="@((p) => p.Name)"
                                                                             ValueSelector="@((p) => p.Id)"
                                                                             EmptyText="Выберите одно или несколько значений"
                                                                             NullDataText="Загружаются значения..." />
                                </div>
                            </div>

                            <p>
                                <div class="form-group row mb-4">

                                    <label for="ttm_cast_coauthors" class="col-form-label col-lg-2">Опубликовать сообщение отделам</label>
                                    <div class="col-lg-10">
                                        <Havit.Blazor.Components.Web.Bootstrap.HxMultiSelect Label="Список отделов"
                                                                                 TItem="@SelectData"
                                                                                 TValue="string"
                                                                                 Data="@select_data_divs"
                                                                                 @bind-Value="SelectedValues_ttm_message_whom_div"
                                                                                 TextSelector="@((p) => p.Name)"
                                                                                 ValueSelector="@((p) => p.Id)"
                                                                                 EmptyText="Выберите одно или несколько значений"
                                                                                 NullDataText="Загружаются значения..." />

                                    </div>
                                </div>
                            </p>

                            <div class="form-group row mb-4">
                                <label for="ttm_info_body" class="col-form-label col-lg-2">Сообщение:</label>
                                <div class="col-lg-10">
                                    <RichTextEdit @ref="rtfMessage"
                                      Theme="RichTextEditTheme.Snow"
                                      ContentChanged="@OnContentChanged_rtfMessage"
                                      PlaceHolder="Введите текст сообщения"
                                      ReadOnly="@readOnly"
                                      SubmitOnEnter="false"
                                      EnterPressed="@OnSave"
                                      ToolbarPosition="Placement.Top">
                                        <Editor></Editor>
                                        <Toolbar>
                                            <RichTextEditToolbarGroup>
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Bold" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Italic" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Align" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Blockquote" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Header" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Strike" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Underline" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.Align" />

                                                <RichTextEditToolbarSelect Action="RichTextEditAction.Size">
                                                    <RichTextEditToolbarSelectItem Value="small" />
                                                    <RichTextEditToolbarSelectItem Selected />
                                                    <RichTextEditToolbarSelectItem Value="large" />
                                                    <RichTextEditToolbarSelectItem Value="huge">Very Big</RichTextEditToolbarSelectItem>
                                                </RichTextEditToolbarSelect>
                                                <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="ordered" />
                                                <RichTextEditToolbarButton Action="RichTextEditAction.List" Value="bullet" />
                                            </RichTextEditToolbarGroup>
                                            <!-- Custom toolbar content -->
                                <RichTextEditToolbarGroup Float="Float.End">
                                                <!-- <Button onClick="window.open('https://www.quilljs.com/','quilljs')"><Icon Name="IconName.InfoCircle" /></Button> -->
                                    <Button Clicked="@OnSave"><Icon Name="IconName.Save" /></Button>
                                            </RichTextEditToolbarGroup>
                                        </Toolbar>
                                    </RichTextEdit>
                                </div>
                            </div>

                            <button type="button" class="btn btn-success waves-effect waves-light" @onclick="post_message">Отправить сообщение</button>

                        </Content>
                    </TabItem>
                }
            }
        }
    </TabItems>
</TabsPanel>

@code {

    [Parameter]
    public bool isAdmin { get; set; }

    [Parameter]
    public schema_users Current_User { get; set; }

    [Parameter]
    public schema_tasks Current_Task { get; set; }

    [Parameter]
    public List<schema_users> Users { get; set; }

    [Parameter]
    public List<schema_divisions> Divisions { get; set; }

    [Parameter]
    public EventCallback<TaskTrackingModelInformation> ttmi_post_message { get; set; }

    [Parameter]
    public EventCallback<TaskTrackingModelCardCommit> ttmcc_send_commit { get; set; }

    [Parameter]
    public EventCallback<TaskTrackingModelWarning> ttmw_send_warning { get; set; }

    [Parameter]
    public EventCallback<TaskTrackingModelAttachments> ttma_post_attachments { get; set; }

    [Parameter]
    public EventCallback<TaskTrackingModelQuestion> ttmq_send_question { get; set; }
}

@code {
    #region Tabs
    private TabsPanel _tabs;
    private TabItem _activeTab;
    private TabItem _tab1;
    private TabItem _tab2;
    private TabItem _tab3;
    private TabItem _tab4;
    private TabItem _tab5;
    private TabItem _tab6;

    private string _activeColor = "DodgerBlue";
    private string _inactiveColor = "LightGray";
    private string _hoverColor = "WhiteSmoke";
    private int _width = 400;
    private int _height = 40;
    private TabPositons _tabPositon = TabPositons.Left;
    private bool _isAnimated = true;
    private bool _allTabsDisabled = false;
    private bool _isTabDisabled = false;
    private bool _isTabHidden = false;

    private int _tabsCount;

    #endregion

    #region Commit Var Zone
    public string ttm_commit_title { get; set; }

    public string ttm_commit_body { get; set; }
    #endregion

    #region Warning Var Zone
    public string ttm_warning_title { get; set; }

    public string ttm_warning_whom { get; set; }

    public string ttm_warning_body { get; set; }
    #endregion

    #region Question Var Zone
    public string ttm_question_title { get; set; }

    public string ttm_question_body { get; set; }
    #endregion


    #region FileDownloadingVariables
    string file_fileName { get; set; }
    long file_UploadedPercentage { get; set; }
    long file_Size { get; set; }
    long file_UploadedBytes { get; set; }

    private List<IBrowserFile> loadedFiles = new();
    private long maxFileSize = 1024 * 15 * 1024;
    private int maxAllowedFiles = 100;
    private bool isLoading;

    #endregion

    #region RichTextEdit Variables

    protected RichTextEdit richTextEditRef;
    protected bool readOnly;
    protected string contentAsHtml;
    protected string contentAsDeltaJson;
    protected string contentAsText;
    protected string savedContent;

    private IList<SelectData> select_data;

    private IList<SelectData> select_data_personal;
    private IList<SelectData> select_data_divs;

    private RichTextEdit rtfWarning;
    private RichTextEdit rtfQuestion;
    private RichTextEdit rtfSenderFile;
    private RichTextEdit rtfMessage;
    private RichTextEdit rtfCommit;

    protected string contentAsHtml_rtfWarning;
    protected string contentAsDeltaJson_rtfWarning;
    protected string contentAsText_rtfWarning;
    protected string savedContent_rtfWarning;

    protected string contentAsHtml_rtfQuestion;
    protected string contentAsDeltaJson_rtfQuestion;
    protected string contentAsText_rtfQuestion;
    protected string savedContent_rtfQuestion;

    protected string contentAsHtml_rtfSenderFile;
    protected string contentAsDeltaJson_rtfSenderFile;
    protected string contentAsText_rtfSenderFile;
    protected string savedContent_rtfSenderFile;

    protected string contentAsHtml_rtfMessage;
    protected string contentAsDeltaJson_rtfMessage;
    protected string contentAsText_rtfMessage;
    protected string savedContent_rtfMessage;

    protected string contentAsHtml_rtfCommit;
    protected string contentAsDeltaJson_rtfCommit;
    protected string contentAsText_rtfCommit;
    protected string savedContent_rtfCommit;

    public async Task OnContentChanged_rtfWarning()
    {
        contentAsHtml_rtfWarning = await rtfWarning.GetHtmlAsync();
        contentAsDeltaJson_rtfWarning = await rtfWarning.GetDeltaAsync();
        contentAsText_rtfWarning = await rtfWarning.GetTextAsync();
    }

    public async Task OnSave_rtfWarning()
    {
        savedContent_rtfWarning = await rtfWarning.GetHtmlAsync();
        await rtfWarning.ClearAsync();
    }

    public async Task OnContentChanged_rtfQuestion()
    {
        contentAsHtml_rtfQuestion = await rtfQuestion.GetHtmlAsync();
        contentAsDeltaJson_rtfQuestion = await rtfQuestion.GetDeltaAsync();
        contentAsText_rtfQuestion = await rtfQuestion.GetTextAsync();
    }

    public async Task OnSave_rtfQuestion()
    {
        savedContent_rtfQuestion = await rtfQuestion.GetHtmlAsync();
        await rtfQuestion.ClearAsync();
    }

    public async Task OnContentChanged_rtfSenderFile()
    {
        contentAsHtml_rtfSenderFile = await rtfSenderFile.GetHtmlAsync();
        contentAsDeltaJson_rtfSenderFile = await rtfSenderFile.GetDeltaAsync();
        contentAsText_rtfSenderFile = await rtfSenderFile.GetTextAsync();
    }

    public async Task OnSave_rtfSenderFile()
    {
        savedContent_rtfSenderFile = await rtfSenderFile.GetHtmlAsync();
        await rtfSenderFile.ClearAsync();
    }

    public async Task OnContentChanged_rtfMessage()
    {
        contentAsHtml_rtfMessage = await rtfMessage.GetHtmlAsync();
        contentAsDeltaJson_rtfMessage = await rtfMessage.GetDeltaAsync();
        contentAsText_rtfMessage = await rtfMessage.GetTextAsync();
    }

    public async Task OnSave_rtfCommmit()
    {
        savedContent_rtfMessage = await rtfCommit.GetHtmlAsync();
        await rtfCommit.ClearAsync();
    }

    public async Task OnContentChanged_rtfCommit()
    {
        contentAsHtml_rtfCommit = await rtfCommit.GetHtmlAsync();
        contentAsDeltaJson_rtfCommit = await rtfCommit.GetDeltaAsync();
        contentAsText_rtfCommit = await rtfCommit.GetTextAsync();
    }

    public async Task OnSave_rtfComming()
    {
        savedContent_rtfCommit = await rtfCommit.GetHtmlAsync();
        await rtfCommit.ClearAsync();
    }
    #endregion

    #region Modals

    private void modal_finishTaskOpen()
    {
        modal_finishTaskOpened = true;
        StateHasChanged();
    }
    private void modal_RefuseDoingOpen()
    {
        modal_RefuseDoingOpened = true;
        StateHasChanged();

    }
    private void modal_DelayOpen()
    {
        modal_DelayOpened = true;
        StateHasChanged();
    }

    private async Task OnTabChanged(TabItem tab)
    {
        _activeTab = tab;
        var index = _tabs.Tabs.ToList().IndexOf(tab);
    }

    #endregion

    bool isFileLoaded { get; set; }

    List<string> attach_lst = new List<string>();
    List<string> attach_lst_links = new List<string>();

}



@code
{

    //modal_open
    bool modal_DelayOpened { get; set; }

    bool modal_RefuseDoingOpened { get; set; }

    bool modal_finishTaskOpened { get; set; }

    public string dlist { get; set; }

    [Parameter]
    public EventCallback<bool> OnClose { get; set; }

    [Parameter]
    public string global_personal_status { get; set; }

    [Parameter]
    public EventCallback<string> OnPersonalStatusChange { get; set; }

    private List<string> selections = new List<string>();
}